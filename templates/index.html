<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ad-Free Music Player</title>
<style>
body { font-family: Arial; background: #111; color: #fff; }
#search { width: 80%; padding: 10px; margin: 20px auto; display:block; }
#results { margin: 20px; }
.song { padding: 10px; border-bottom: 1px solid #444; cursor:pointer; }
.audio-player { width: 100%; margin-top: 20px; }
</style>
</head>
<body>

<input type="text" id="search" placeholder="Search song / artist..." />
<div id="results"></div>
<audio controls class="audio-player" id="player"></audio>

<script>
const searchBox = document.getElementById('search');
const resultsDiv = document.getElementById('results');
const player = document.getElementById('player');

searchBox.addEventListener('keypress', async (e) => {
  if(e.key === 'Enter') {
    const query = searchBox.value.trim();
    resultsDiv.innerHTML = "Loading...";
    const res = await fetch(`https://adfree-proxy.onrender.com/search?q=${encodeURIComponent(query)}`);
    const data = await res.json();
    
    resultsDiv.innerHTML = "";
    data.forEach(song => {
      if(song.audio_links.length > 0) {
        const div = document.createElement('div');
        div.className = "song";
        div.innerHTML = `<strong>${song.title}</strong> - ${song.artist || "Unknown"}<br/><small>${song.source_url}</small>`;
        div.onclick = () => {
          player.src = song.audio_links[0];
          player.play();
        };
        resultsDiv.appendChild(div);
      }
    });
    if(resultsDiv.innerHTML === "") resultsDiv.innerHTML = "No songs found!";
  }
});
</script>
</body>
</html>
